Passo 1: Modifiche al codice (per Automazione e Portabilità)
Prima di creare l'eseguibile, dobbiamo fare due piccole modifiche a server.js per renderlo perfetto.

A. Generazione automatica del QR Code Installa questa libreria nel tuo progetto:

Bash

npm install qrcode-terminal
Ora apri server.js e aggiungi questo all'inizio (sotto gli altri require):

JavaScript

const qrcode = require('qrcode-terminal');
E modifica la parte finale (server.listen) così, in modo che stampi il QR code direttamente nella finestra nera:

JavaScript

server.listen(PORT, () => {
    const ipAddress = ip.address();
    const url = `http://${ipAddress}:${PORT}/mobile.html`;
    
    console.log(`\n--- SARABANDA SERVER PRONTO ---`);
    console.log(`Il Giudice deve aprire: http://localhost:${PORT}`);
    console.log(`\nFai scansionare questo QR Code agli amici per giocare:`);
    
    // Genera il QR Code piccolo nel terminale
    qrcode.generate(url, {small: true});
    
    console.log(`(Oppure digita: ${url})\n`);
});
B. Rendere le cartelle modificabili (IMPORTANTE) Se impacchettiamo tutto in un .exe, le cartelle GIF e Sounds finiscono "sigillate" dentro il file. Ma tu vuoi che il tuo amico possa cambiare i suoni o le GIF. Dobbiamo dire al codice: "Non cercare le GIF dentro l'eseguibile, cercale nella cartella dove si trova il file".

In server.js, cerca tutte le righe che usano __dirname per GIF, Sounds e Hint e cambiale con process.cwd().

Esempio (Modifica queste righe):

JavaScript

// PRIMA ERA: app.use('/GIF', express.static(path.join(__dirname, 'GIF')));
// DIVENTA:
app.use('/GIF', express.static(path.join(process.cwd(), 'GIF')));

// PRIMA ERA: app.use('/Sounds', express.static(path.join(__dirname, 'Sounds')));
// DIVENTA:
app.use('/Sounds', express.static(path.join(process.cwd(), 'Sounds')));

// Fai lo stesso per le API che leggono le cartelle (fs.readdir)
// app.get('/api/gifs', ...) -> path.join(process.cwd(), 'GIF')
// app.get('/api/sounds', ...) -> path.join(process.cwd(), 'Sounds')
// app.get('/api/hints', ...) -> path.join(process.cwd(), 'Hint')
Nota: Lascia public con __dirname, perché l'interfaccia web non deve essere modificata dall'utente.

Passo 2: Creare l'Eseguibile (.exe)
Ora usiamo pkg. È uno strumento magico che prende il tuo codice Node.js e crea un .exe.

Installa pkg globalmente: apri il terminale e scrivi:

Bash

npm install -g pkg
Prepara il package.json: Apri il file package.json e aggiungi questa riga "bin": "server.js", subito sotto a "main".

Esempio:

JSON

{
  "name": "sarabanda-party",
  "version": "1.0.0",
  "main": "server.js",
  "bin": "server.js", 
  ...
}
Crea l'eseguibile: Nel terminale, nella cartella del progetto, lancia questo comando (ci metterà un po'):

Bash

pkg . --targets node18-win-x64 --output SarabandaGame
(Questo comando crea un file SarabandaGame.exe per Windows a 64bit).